<Window x:Class="EyeOut.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        
        xmlns:local="clr-namespace:EyeOut" 
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"      
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        
        Closing="Window_Closing" 
        
        Title="MainWindow" Height="700" Width="800"
        >
    <!--Closed="Window_Closed"-->




    <!--instances of binding classes, styles definitions-->
    <Window.Resources>
        <!--new instance of C_controlMot named controlMot-->
        <local:C_SPI x:Key="spi"/>
        <!--<local:App x:Key="app"/>-->

        <local:C_Motor x:Name="motYaw" x:Key="motYawDataSource"/>

        <!--Filtering and sorting of datagrid dgLog-->
        <CollectionViewSource x:Key="ItemCollectionViewSource"  
                              CollectionViewType="ListCollectionView"
                              Filter="CollectionViewSource_Filter">
            <CollectionViewSource.SortDescriptions>
                <!-- Requires 'xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"' declaration. -->
                <scm:SortDescription PropertyName="time" Direction="Descending"/>
                <!--<scm:SortDescription PropertyName="Complete" />
                <scm:SortDescription PropertyName="DueDate" />-->
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
        <!--checkbox for filterming dgLog-->
        <ObjectDataProvider x:Key="enumValues" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:e_LogMsgSource"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>

    <Grid >
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="5" />
            <RowDefinition Height="100"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>
        <TabControl Grid.Row="0">
            <TabItem Header="Dynamixel Motors" Background="Orange">
                <!--<Grid Background="#FFE5E5E5">-->
                <Grid Background="Orange">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="142" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <DockPanel Grid.Column="0" Grid.Row="0">
                        <GroupBox DockPanel.Dock="Top" Header="Connection control">
                            <StackPanel>
                                <GroupBox Header="Protocol" >
                                    <StackPanel>
                                        <Label Content="COM Port:"/>
                                        <ComboBox Name="cbPort">
                                            <ComboBox.SelectedValue>
                                                <Binding Source="{StaticResource spi}" Path="PortName"/>
                                            </ComboBox.SelectedValue>
                                        </ComboBox>
                                        <Button Name="btnRescanPort" Content="Rescan Ports" Click="btnRescanPort_Click" />
                                        <Label Content="Selected [bps]:"/>
                                        <TextBox Name="txBaudRate" Background="#FF66FF4E">
                                            <TextBox.Text>
                                                <!--<Binding ElementName="lsBaudRate" Path="SelectedValue"/>-->
                                                <Binding Source="{StaticResource spi}" Path="BaudRate">
                                                    <Binding.ValidationRules>
                                                        <ExceptionValidationRule/>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                        <Label Content="BaudRate list:"/>
                                        <ListBox x:Name="lsBaudRate" MinHeight="20" SelectionMode="Single" SelectedIndex="0">
                                            <ListBox.SelectedValue>
                                                <Binding Source="{StaticResource spi}" Path="BaudRate">
                                                    <Binding.ValidationRules>
                                                        <ExceptionValidationRule/>
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </ListBox.SelectedValue>

                                        </ListBox>
                                    </StackPanel>
                                </GroupBox>
                                <Button Name="btnConnect" Content="Connect" Click="btnConnect_Click" />

                                <!--<Check Content="Connect" Appearence="Button" />-->
                                <ToggleButton Content="Push to Connect" />
                            </StackPanel>
                        </GroupBox>
                        <GroupBox DockPanel.Dock="Top" Header="Motor settings" >
                            <StackPanel>
                                <Button Content="Search for connected" />
                                <GroupBox Header="Select">
                                    <ListBox Name="lsMot" MinHeight="40"/>
                                </GroupBox>
                                <GroupBox Header="Selected motor info" VerticalAlignment="Top">
                                    <StackPanel>
                                        <ListBox Name="lsInfo" MinHeight="40" SelectionMode="Multiple"/>
                                        <TextBox>
                                            Selected information
                                        </TextBox>
                                    </StackPanel>
                                </GroupBox>

                            </StackPanel>
                        </GroupBox>

                        <Button DockPanel.Dock="Top" MaxHeight="20" Content="START motors" VerticalAlignment="Top" Click="btnStartMotors_Click" />
                    </DockPanel>
                    <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" />

                    <Grid Grid.Column="2" Background="#FFE5E5E5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height= "*" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>


                        <DockPanel Grid.Row="0" >
                            <Grid Grid.Column="2" Background="#FFE5E5E5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="5" />
                                    <ColumnDefinition Width="250" />
                                </Grid.ColumnDefinitions>

                                <Grid Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="30" />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="30"/>
                                    </Grid.RowDefinitions>
                                    <TextBox Grid.Column="0" Grid.Row="0" 
                                             DataContext="{Binding Source={StaticResource motYawDataSource}}"
                                            Text="{Binding angleDeg, Mode=Default}"/>

                                    <Slider x:Name="slYaw" Grid.Column="0" Grid.Row="1" 
                                            Maximum="360" SmallChange="0.1" TickFrequency="45" TickPlacement="TopLeft" UseLayoutRounding="True"
                                            ValueChanged="slYaw_ValueChanged"/>
                                    <!--DataContext="{Binding Source={StaticResource motYawDataSource}}"
                                            Value="{Binding angleDeg, Mode=Default}"-->
                                    <Slider x:Name="slPitch"  Grid.Column="1" Grid.Row="0" Orientation="Vertical"
                                            Maximum="360" SmallChange="0.1" TickFrequency="45" TickPlacement="TopLeft"
                                            ValueChanged="slPitch_ValueChanged"/>

                                    <StackPanel Grid.Column="1" Grid.Row="1" >
                                        <TextBox FontSize="7" TextAlignment="Center"
                                        Text="{Binding ElementName=slPitch, Path=Value, UpdateSourceTrigger=PropertyChanged}"/>
                                        <TextBox FontSize="7" TextAlignment="Center"
                                        Text="{Binding ElementName=slYaw, Path=Value, UpdateSourceTrigger=PropertyChanged}"/>
                                    </StackPanel>
                                </Grid>

                                <GridSplitter Grid.Column="2" HorizontalAlignment="Stretch" />

                                <GroupBox Grid.Column="3" x:Name="gpCmds" Header="Example commands" >
                                    <Grid>
                                        <DockPanel>
                                            <ListBox x:Name="lsCmdEx" DockPanel.Dock="Top" MinHeight="40" MouseDoubleClick="lsCmdEx_wannaSend" KeyDown="lsCmdEx_wannaSend" />
                                            <CheckBox x:Name="cbExampleDoubleClick" Content="Send by DoubleClick and Enter" DockPanel.Dock="Top" IsChecked="True"/>
                                            <Button Name="btnSendExample" Content="Send selected [Example command]" VerticalAlignment="Top" DockPanel.Dock="Top" MaxHeight="20" Click="btnSendExample_wannaSend">
                                            </Button>
                                        </DockPanel>
                                    </Grid>
                                </GroupBox>
                            </Grid>
                        </DockPanel>

                        <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" />

                        <DockPanel Grid.Row="2" >
                            <Grid Grid.Column="2" Background="#FFE5E5E5">
                                <Grid Grid.Column="2" Background="#FFE5E5E5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="5" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBox Name="txLogMot" Grid.Column="0">Log</TextBox>
                                    <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" />
                                    <TextBox Grid.Column="2">Info</TextBox>
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Basler Camera" Background="GreenYellow">
                <Grid Background="GreenYellow">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="85*"/>
                        <ColumnDefinition Width="169*"/>
                    </Grid.ColumnDefinitions>
                    <Image HorizontalAlignment="Left" Height="100" Margin="227.5,10,0,0" VerticalAlignment="Top" Width="100" Source="pack://siteoforigin:,,,/pic/eyeout.png" Grid.Column="1"/>
                </Grid>
            </TabItem>

            <TabItem Header="Oculus Headset" Background="DeepSkyBlue">
                <Grid Background="DeepSkyBlue" Width="175" Height="150">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Column="0" Grid.Row="0">
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png"  />
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png"  />
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png"  Stretch="Fill"/>
                    </DockPanel>

                    <StackPanel Grid.Column="0" Grid.Row="1"  Orientation="Horizontal">
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png"  />
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png" />
                        <Image Source="pack://siteoforigin:,,,/pic/eyeout.png" Stretch="Fill"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="EyeOut Telepresence" Foreground="Wheat" Background="Black">
                <!--<Grid Background="#FFE5E5E5">-->
                <Grid Background="Black" >

                </Grid>
            </TabItem>
        </TabControl>

        <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" />

        <!--LOG start-->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50"/>
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <ListBox x:Name="lsLogSrcSelction" ItemsSource="{Binding Source={StaticResource enumValues}}" SelectionMode="Multiple" SelectionChanged="CompleteFilter_Changed"/>
                <ToggleButton Content="See All" Checked="LogFilterCheckAll" Unchecked="LogFilterUncheckAll"/>
            </StackPanel>
            <DataGrid Grid.Column="1"
            x:Name="dgLog"
              DataContext="{StaticResource ItemCollectionViewSource}"
              ItemsSource="{Binding}"
              AutoGenerateColumns = "False" 
              CanUserAddRows="False"
            >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Time"  IsReadOnly="True" Binding="{Binding Path=time, StringFormat=HH:mm:ss.fff}" Width="76" 
                                    ></DataGridTextColumn>
                    <DataGridTextColumn Header="Type" IsReadOnly="True"  Binding="{Binding Path=type}" Width="50"></DataGridTextColumn>
                    <DataGridTextColumn Header="Source" IsReadOnly="True"  Binding="{Binding Path=src}" Width="50"></DataGridTextColumn>
                    <DataGridTextColumn Header="Message" IsReadOnly="True"  Binding="{Binding Path=msg}" MinWidth="50" ></DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>


        </Grid>
        <!--LOG end-->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <Label x:Name="tslConnected" Content="Connected" BorderThickness="1" BorderBrush="Black"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
